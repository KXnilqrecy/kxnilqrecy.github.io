<!doctype html>
<html>
  <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E4NPYH1T62"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E4NPYH1T62');
</script>
    <meta charset="utf-8">
    <title>でたらめ短歌</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="https://kxnilqrecy.github.io/assets/images/favicon.png">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link type="application/atom+xml" rel="alternate" href="https://kxnilqrecy.github.io/feed.xml" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>でたらめ短歌</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="でたらめ短歌" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="でたらめ短歌 上の窓に何か入力してみてください" />
<meta property="og:description" content="でたらめ短歌 上の窓に何か入力してみてください" />
<link rel="canonical" href="https://kxnilqrecy.github.io/subcontents/utils.html" />
<meta property="og:url" content="https://kxnilqrecy.github.io/subcontents/utils.html" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-03-28T18:07:33+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="でたらめ短歌" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-03-28T18:07:33+09:00","datePublished":"2025-03-28T18:07:33+09:00","description":"でたらめ短歌 上の窓に何か入力してみてください","headline":"でたらめ短歌","mainEntityOfPage":{"@type":"WebPage","@id":"https://kxnilqrecy.github.io/subcontents/utils.html"},"url":"https://kxnilqrecy.github.io/subcontents/utils.html"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="google-site-verification" content="1XS-_jxYV-ZnPNosmqWTDri7p8729Qo40Ylm4px0YWA" />
  </head>
  <body class="c7">
    <div class="clock">
    <div id="clock2">ここに長期暦を表示</div>
    <div id="clock">ここに暦を表示</div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
    fetch('https://kxnilqrecy.github.io/assets/csv/jungo.csv')
        .then(response => response.text())
        .then(data => parseCSV(data));
});
function decToBase62(num_){
  if (num_ === null) return void 0;
  let num = Number(num_);
  if (isNaN(num)) return void 0;
  if (Math.floor(num) !== num) return void 0;
  
  let is_negative = num < 0;
  num = Math.abs(num);
  
  let ret = "", digit = 0;
  while(true){
    digit = num % 62;
    if (digit < 10)
      ret+=String(digit); //0-9
    else if (digit < 36)
      ret+=String.fromCharCode(digit + 55); //A-Z
    else
      ret+=String.fromCharCode(digit + 61); //a-z
    if (num < 62)
      break;
    else
      num = Math.floor(num / 62);
  }
  if (is_negative) ret+="-";
  return ret.split("").reverse().join("");
}
function parseCSV(data) {
    const jungos = data.split('\n');
    const lpmark = ['🌑', '🌒', '🌓', '🌔', '🌕', '🌖', '🌗', '🌘', '🌑'];
    let nowdate = new Date();
    const epochdate = new Date(2019, 4, 1, 18);
    let deltadate = (nowdate.getTime() - epochdate.getTime()) / 1000 / 86400;
    let day = Math.floor(deltadate);
    let time = (deltadate - day);
    let hisuiepoch = new Date(2005, 7, 15);
    let hisuinum = Math.floor((nowdate.getTime() - hisuiepoch.getTime()) / 86400000);
    let nowjungo = jungos[day];
    let koku = Math.floor((time * 96) * 10) / 10;
    const lunarepoch = new Date(2019, 4, 5, 7, 45);
    let lunardelta = (nowdate.getTime() - lunarepoch.getTime()) / 1000 / 86400;
    let lp = Math.floor((lunardelta - Math.floor(lunardelta / 29.530582990) * 29.530582990) * 10) / 10;
    let lpmknum = Math.floor((lunardelta - Math.floor(lunardelta / 29.530582990) * 29.530582990) / 29.530582990 * 8 + 0.5);
    let mk = lpmark[lpmknum];
    const xqepoch = new Date(2018, 8, 23, 10, 54);
    let xqdelta = (nowdate.getTime() - xqepoch.getTime()) / 1000 / 86400;
    let xq = Math.floor(Math.ceil(xqdelta / 365.242050827423) * 365.242050827423 - xqdelta);
    const qiepoch = new Date(2005, 8, 23, 7, 23);
    let qidelta = (nowdate.getTime() - qiepoch.getTime()) / 1000 / 86400;
    let qi = Math.floor(qidelta / 52.177435832489);
    document.getElementById('clock').textContent = `Xq${xq}Lp${lp}${mk}/${nowjungo}(第${qi}期):&${hisuinum}-${koku}刻`;
    const longepoch = new Date(-5513, 8, 26);
    let longdelta = nowdate.getTime() - longepoch.getTime();
    let long1 = ('0000' + decToBase62(longdelta % 14776334)).slice(-4);
    let long2 = ('0000' + decToBase62(longdelta % 14776331)).slice(-4);
    let long3 = ('0000' + decToBase62(longdelta % 14776329)).slice(-4);
    let long4 = ('0000' + decToBase62(longdelta % 14776327)).slice(-4);
    document.getElementById('clock2').textContent = `${long1}.${long2}.${long3}.${long4}`;
}
    </script>
</div>
    <h1>でたらめ短歌</h1>
<input type="text" size="30" id="inputText">
<input type="button"  value="入力" id="checkButton"><br>
<p id="outputText">上の窓に何か入力してみてください</p>
<script>
function xorWithConstant(inputArray, constantValue) {
    if (!(inputArray instanceof Uint8Array) || inputArray.length !== 32) {
        throw new Error("Input must be a Uint8Array of length 32.");
    }

    // Ensure constantValue is a 64-character hexadecimal string
    if (typeof constantValue !== 'string' || !/^[0-9a-fA-F]{64}$/.test(constantValue)) {
        throw new Error("Constant value must be a 64-character hexadecimal string.");
    }

    // Convert the constantValue to a Uint8Array
    const constantArray = new Uint8Array(32);
    for (let i = 0; i < 32; i++) {
        constantArray[i] = parseInt(constantValue.slice(i * 2, i * 2 + 2), 16);
    }

    const resultArray = new Uint8Array(32);

    for (let i = 0; i < inputArray.length; i++) {
        resultArray[i] = inputArray[i] ^ constantArray[i];
    }

    return resultArray;
}

function displayResults(inputArray) {
    const constantValue = "F38F829062FB567A447A77EAB0B858A401B1F03FA63DB91FCF4919C0AF81D727"; // XOR演算に使う64桁の16進数
    const jpMora = ['あ', 'い', 'う', 'え', 'お', 'か', 'き', 'く', 'け', 'こ', 'きゃ', 'きゅ', 'きぇ', 'きょ', 'くゎ', 'くぃ', 'くぇ', 'くぉ', 'が', 'ぎ', 'ぐ', 'げ', 'ご', 'ぎゃ', 'ぎゅ', 'ぎぇ', 'ぎょ', 'ぐゎ', 'ぐぃ', 'ぐぇ', 'ぐぉ', 'さ', 'し', 'す', 'せ', 'そ', 'しゃ', 'しゅ', 'しぇ', 'しょ', 'すぃ', 'ざ', 'じ', 'ず', 'ぜ', 'ぞ', 'じゃ', 'じゅ', 'じぇ', 'じょ', 'ずぃ', 'た', 'ち', 'つ', 'て', 'と', 'ちゃ', 'ちゅ', 'ちぇ', 'ちょ', 'つぁ', 'つぃ', 'つぇ', 'つぉ', 'てゃ', 'てぃ', 'てゅ', 'てょ', 'とぅ', 'とぇ', 'だ', 'ぢ', 'づ', 'で', 'ど', 'でゃ', 'でぃ', 'でゅ', 'でょ', 'どぅ', 'どぇ', 'な', 'に', 'ぬ', 'ね', 'の', 'にゃ', 'にゅ', 'にぇ', 'にょ', 'は', 'ひ', 'ふ', 'へ', 'ほ', 'ひゃ', 'ひゅ', 'ひぇ', 'ひょ', 'ふぁ', 'ふぃ', 'ふぇ', 'ふぉ', 'ふゅ', 'ば', 'び', 'ぶ', 'べ', 'ぼ', 'びゃ', 'びゅ', 'びぇ', 'びょ', 'ぱ', 'ぴ', 'ぷ', 'ぺ', 'ぽ', 'ぴゃ', 'ぴゅ', 'ぴぇ', 'ぴょ', 'ま', 'み', 'む', 'め', 'も', 'みゃ', 'みゅ', 'みぇ', 'みょ', 'や', 'ゆ', 'よ', 'ら', 'り', 'る', 'れ', 'ろ', 'りゃ', 'りゅ', 'りぇ', 'りょ', 'わ', 'うぃ', 'うぇ', 'を', 'ん', 'っ'];
    const resultArray = xorWithConstant(inputArray, constantValue);

    // Uint8Arrayを一つの整数として扱う
    let combinedValue = 0n; // BigIntで処理
    for (let i = 0; i < resultArray.length; i++) {
        combinedValue = (combinedValue << 8n) | BigInt(resultArray[i]);
    }

    let quot = combinedValue;
    let rem1 = "";
    let rem2 = "";
    let rem3 = "";
    let rem4 = "";
    let rem5 = "";

    for (let i = 0; i < 5; i++) {
        rem1 += jpMora[Number(quot % 149n)];
        quot = quot / 149n;
    }
    for (let i = 0; i < 7; i++) {
        rem2 += jpMora[Number(quot % 149n)];
        quot = quot / 149n;
    }
    for (let i = 0; i < 5; i++) {
        rem3 += jpMora[Number(quot % 149n)];
        quot = quot / 149n;
    }
    for (let i = 0; i < 7; i++) {
        rem4 += jpMora[Number(quot % 149n)];
        quot = quot / 149n;
    }
    for (let i = 0; i < 7; i++) {
        rem5 += jpMora[Number(quot % 149n)];
        quot = quot / 149n;
    }
    const rem = [rem1, rem2, rem3, rem4, rem5].join('<br>');

    // HTMLに反映
    const outputText = document.getElementById("outputText");
    if (outputText) {
        outputText.innerHTML = rem;
    } else {
        console.error("outputText要素が見つかりません。");
    }
}

async function digestMessage(message) {
  const msgUint8 = new TextEncoder().encode(message); // (utf-8 の) Uint8Array にエンコードする
  const hashBuffer = await crypto.subtle.digest("SHA-256", msgUint8); // メッセージをハッシュする
  const hashArray = Array.from(new Uint8Array(hashBuffer)); // バッファーをバイト列に変換する
  return hashArray;
}
function clickButton() {
  const inputValue = document.getElementById('inputText').value;
  digestMessage(inputValue)
    .then((digest) => displayResults(new Uint8Array(digest)))
    .catch((error) => console.error("エラー:", error));
}

let checkButton = document.getElementById('checkButton');
checkButton.addEventListener('click', clickButton);
</script>
    <hr>
    <nav>
    <div class="center">サイトナビゲーション<br>
    
      <a href="/" >Home</a>
    
      <a href="/subcontents/blog.html" >「久入すいう」のブログ</a>
    
      <a href="/subcontents/pseudrences.html" >夢似科学研究所</a>
    
      <a href="/subcontents/tankas.html" >千翠れいしの短歌集</a>
    
      <a href="/subcontents/conlangs.html" >久入言語研究室</a>
    
      <a href="/subcontents/staff.html" >構成員</a>
    
      <a href="/about.html" >恵生ニルクレシィについて</a>
    
    </div>
</nav>
  </body>
</html>